---
import { getCollection } from 'astro:content';

import ArrowDown from '@/assets/icons/arrow-down.svg';
import ArrowRight from '@/assets/icons/arrow-right.svg';
import Asterism from '@/assets/icons/asterism.svg';
import Bridge from '@/assets/icons/bridge.svg';
import Cheese from '@/assets/icons/cheese.svg';
import Cli from '@/assets/icons/cli.svg';
import Me from '@/assets/icons/me.svg';
import Wiggle from '@/assets/images/wiggle.svg';
import Funston from '@/assets/images/funston.png';
import Layout from '@/layouts/Layout.astro';
import { Image } from 'astro:assets';

const posts = await getCollection('blog').then((response) =>
    response.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
);
---

<style
    set:text={`
    :root {
        --wiggle: url(${Wiggle.src});
    }`}
></style>

<style>
    .funston {
        height: 100%;
        left: 0;
        mix-blend-mode: luminosity;
        object-fit: auto 100%;
        object-position: 0 0;
        opacity: 0.12;
        position: absolute;
        top: 0;
        width: 100%;
        z-index: -1;
    }

    .title,
    .about,
    .blog,
    .hobbies {
        grid-column: 1 / -1;
        margin-block-end: calc(var(--spacing) * 3);
        max-width: calc(var(--spacing) * 67);

        svg:not(.asterism) {
            height: 0.84em;
            width: auto;
        }
    }

    .title {
        background: var(--wiggle) repeat-x 0 100% / auto calc(var(--spacing) / 2);
        font-size: var(--step-5);
        padding-block-end: calc(var(--spacing) * 3 + var(--spacing) / 2);

        span {
            align-items: center;
            display: inline-flex;
            gap: 0.5ch;
        }
    }

    .me {
        color: var(--green-2);
    }

    .about p,
    .hobbies p {
        font-size: var(--step-2);
        font-weight: 200;
    }

    .about,
    .blog h2 {
        a {
            --_color: var(--blue-1);
            --_bg-active: var(--blue-1);

            font-weight: 500;

            &:focus-visible,
            &:hover {
                --_color: var(--green-6);
            }
        }
    }

    .blog {
        ol {
            list-style: none;
            padding-inline: 0;
        }

        li {
            padding: 0;

            &:not(:last-child) {
                margin-block-end: calc(var(--spacing) * 0.5);
            }
            a {
                --_bg: transparent;
                --_bg-active: var(--purple-1);

                align-items: center;
                background-color: color-mix(in srgb, transparent, var(--purple-1) 24%);
                display: flex;
                font-size: 18px;
                gap: 0.5ch;
                padding: 1em;
                width: fit-content;

                &:focus-visible,
                &:hover {
                    --_color: var(--blue-1);
                }
            }
        }
    }

    .more {
        margin-block-start: calc(var(--spacing) * 2);

        a {
            align-items: center;
            display: flex;
            font-weight: 500;
            width: fit-content;
        }

        svg {
            margin-inline-start: 0.5ch;
        }
    }

    .hobbies {
        margin: unset;
    }
</style>

<Layout title="Home" bodyClass="home-page" wrapperClass="wrapper--home">
    <header class="title">
        <Asterism role="presentation" class="asterism" />
        <h1>
            Hi! I’m
            <span>
                <Me role="presentation" class="me" />
                <strong class="me">Doug Stewart</strong>
            </span> a
            <span>
                <Cli role="presentation" />
                <strong>software developer</strong>
            </span> and
            <span>
                <Cheese role="presentation" />
                <strong>team leader</strong>
            </span> living in
            <span>
                <Bridge role="presentation" />
                <strong>San Francisco, CA</strong>
            </span>.
        </h1>
    </header>
    <section class="about">
        <p>
            For more than 15 years I’ve been making amazing websites and leading teams for <a
                href="https://www.krafton.com/">Krafton Americas</a
            >, <a href="https://www.togetherlabs.com/">Together Labs</a>, <a
                href="https://www.kongregate.com/">Kongregate</a
            >, and <a href="https://www.linkedin.com/company/tag-new-media/about/">Tag New Media</a
            >; and I’ve worked with amazing brands like <a href="https://www.uperform.com/"
                >ANCILE Solutions</a
            >, <a href="https://www.keurig.com/">Keurig</a>, <a href="https://www.gillette.com/"
                >Gillette</a
            >, <a href="https://www.rossignol.com/">Rossignol</a>, and many others.
        </p>
        <p>
            You can find me on <a href="https://codesandbox.io/u/doug-stewart">CodeSandbox.io</a> and
            <a href="https://github.com/doug-stewart">GitHub</a>.
            <br />
            If you want to connect I&rsquo;m on <a href="https://www.linkedin.com/in/dougmstewart/"
                >LinkedIn</a
            > or just <a href="/contact">email me</a>.
        </p>
    </section>
    <section class="blog">
        <h2>Sometimes I write <ArrowDown role="presentation" /></h2>
        <ol>
            {
                posts.map((post) => (
                    <li>
                        <a href={`/blog/${post.slug}`}>
                            {post.data.title}
                            <ArrowRight role="presentation" />
                        </a>
                    </li>
                ))
            }
        </ol>
        <p class="more">
            <a href="/blog">There&rsquo;s more <ArrowRight role="presentation" /></a>
        </p>
    </section>
    <section class="hobbies">
        <p>
            When I&rsquo;m not doing the code monkey thing I ride my motorcycle and do some casual
            photography.
        </p>
    </section>
    <Image src={Funston} alt="" role="presentation" class="funston" />
</Layout>
